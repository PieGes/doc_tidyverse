<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Pierre Gestraud" />


<title>ggplot2</title>

<script src="ggplot2_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="ggplot2_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="ggplot2_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="ggplot2_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="ggplot2_files/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="ggplot2_files/highlight/default.css"
      type="text/css" />
<script src="ggplot2_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script src="ggplot2_files/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">ggplot2</h1>
<h4 class="author"><em>Pierre Gestraud</em></h4>
<h4 class="date"><em>4 octobre 2016</em></h4>

</div>


<div id="example-data" class="section level3">
<h3>Example data</h3>
<pre class="r"><code>head(mpg)</code></pre>
<pre><code>##   manufacturer model displ year cyl      trans drv cty hwy fl   class
## 1         audi    a4   1.8 1999   4   auto(l5)   f  18  29  p compact
## 2         audi    a4   1.8 1999   4 manual(m5)   f  21  29  p compact
## 3         audi    a4   2.0 2008   4 manual(m6)   f  20  31  p compact
## 4         audi    a4   2.0 2008   4   auto(av)   f  21  30  p compact
## 5         audi    a4   2.8 1999   6   auto(l5)   f  16  26  p compact
## 6         audi    a4   2.8 1999   6 manual(m5)   f  18  26  p compact</code></pre>
</div>
<div id="quickstart" class="section level3">
<h3>Quickstart</h3>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<p>A plot has 3 main components:</p>
<ul>
<li>data</li>
<li>a set of aesthetics</li>
<li>a set of layers (mainly geometries)</li>
</ul>
<pre class="r"><code>ggplot(mpg,   ## data
       aes(x = displ, y = hwy)) +  ## aesthetics
    geom_point() ## layer</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="aesthetics" class="section level3">
<h3>aesthetics</h3>
<ul>
<li><code>x</code></li>
<li><code>y</code></li>
<li><code>z</code></li>
<li><code>color</code></li>
<li><code>fill</code></li>
<li><code>size</code></li>
<li><code>text</code></li>
</ul>
<p>Set color aesthetic to <code>manufacturer variable</code></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = manufacturer)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<p>Set size aesthetic</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, size = cyl)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<p>Alpha aesthetic</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, size = cyl, color = class)) + geom_point(alpha = 0.5)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
<p>Set an aesthetic to a fixed value</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(aes(color = &quot;blue&quot;))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(color = &quot;blue&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-7-2.png" alt="" /><!-- --></p>
<p>Set an aestetic to a discrete numeric value</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = cyl)) + geom_point() ## gradient scale</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = factor(cyl))) + geom_point() ## discrete scale</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-8-2.png" alt="" /><!-- --></p>
<p>Aesthetics can be defined inside geom</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(aes(color = class))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
<p>Aesthetics defined inside <code>ggplot</code> apply to all geom</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy, color = class)) + geom_boxplot() + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="a-ggplot-is-an-object" class="section level3">
<h3>a ggplot is an object</h3>
<p>We can build a <code>ggplot</code> object in several steps</p>
<pre class="r"><code>g &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() 
g ## or print(g)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
<pre class="r"><code>g &lt;- g + ggtitle(&quot;hwy vs displ&quot;)
g</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-11-2.png" alt="" /><!-- --></p>
</div>
<div id="geom" class="section level3">
<h3>geom</h3>
<ul>
<li>one variable
<ul>
<li>continous
<ul>
<li><code>geom_density</code></li>
<li><code>geom_histogram</code></li>
<li><code>geom_freqpoly</code></li>
</ul></li>
<li>discrete
<ul>
<li><code>geom_bar</code></li>
</ul></li>
</ul></li>
<li>two variables
<ul>
<li>continous X, continuous Y
<ul>
<li><code>geom_point</code></li>
<li><code>geom_smooth</code></li>
<li><code>geom_text</code></li>
</ul></li>
<li>discrete X, continuous Y
<ul>
<li><code>geom_bar</code></li>
<li><code>geom_boxplot</code></li>
<li><code>geom_violin</code></li>
</ul></li>
<li>bivariate distribution
<ul>
<li><code>geom_density2d</code></li>
<li><code>geom_hex</code></li>
<li><code>geom_bin2d</code></li>
</ul></li>
<li>continuous function
<ul>
<li><code>geom_line</code></li>
<li><code>geom_step</code></li>
</ul></li>
</ul></li>
<li>three variables
<ul>
<li><ul>
<li><code>geom_contour</code></li>
<li><code>geom_tile</code></li>
</ul></li>
</ul></li>
</ul>
<div id="data-distributions" class="section level4">
<h4>data distributions</h4>
<p>For histograms and densities only <code>x</code> is mandatory</p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_histogram()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_density()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-12-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_freqpoly()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-12-3.png" alt="" /><!-- --></p>
<p>Changing bins</p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_histogram(bins = 30)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-13-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_histogram(binwidth = 2)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-13-2.png" alt="" /><!-- --></p>
<p>Manually setting breaks</p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_histogram(breaks = c(10, 15, 20, 25, 30, 40, 50))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-14-1.png" alt="" /><!-- --></p>
<p>Add fill or color</p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_density(fill = &quot;blue&quot;, color = &quot;red&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-15-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = hwy)) + geom_density(aes(fill = class))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-15-2.png" alt="" /><!-- --></p>
</div>
<div id="boxplots-violins-jitter" class="section level4">
<h4>Boxplots, violins, jitter</h4>
<p>boxplots need <code>x</code> and <code>y</code> aestetics</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy, fill = class)) + geom_boxplot()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-16-2.png" alt="" /><!-- --></p>
<p>Add another variable as fill or color will separate boxplots</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy, fill = trans)) + geom_boxplot()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
<p>Violin plots</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_violin()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-18-1.png" alt="" /><!-- --></p>
<p>Jitters</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_jitter()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-19-1.png" alt="" /><!-- --></p>
<pre class="r"><code>## control width and height of jitter
ggplot(mpg, aes(x = class, y = hwy)) + geom_jitter(width = 0.5, height = 0)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-19-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot() + geom_jitter(width = 0.5, height = 0)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
</div>
<div id="bars" class="section level4">
<h4>Bars</h4>
<pre class="r"><code>ggplot(mpg, aes(x = manufacturer)) + geom_bar()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></p>
<p>Adding color</p>
<pre class="r"><code>ggplot(mpg, aes(x = manufacturer, fill = class)) + geom_bar()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>
<p>Changing bars positions</p>
<pre class="r"><code>ggplot(mpg, aes(x = manufacturer, fill = class)) + geom_bar(position = &quot;stack&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = manufacturer, fill = class)) + geom_bar(position = &quot;dodge&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-23-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = manufacturer, fill = class)) + geom_bar(position = &quot;fill&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-23-3.png" alt="" /><!-- --></p>
<p>Bar plot from count data</p>
<pre class="r"><code>d &lt;- data.frame(group = c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;), n = c(10, 25 , 14))</code></pre>
<pre class="r"><code>## error
## ggplot(d, aes(x = group, y = n)) + geom_bar()
ggplot(d, aes(x = group, y = n)) + geom_bar(stat = &quot;identity&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-25-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="add-a-smoother-on-the-plot" class="section level3">
<h3>add a smoother on the plot</h3>
<p>Default smoother (loess if &lt;1000 obs, gam otherwise)</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_smooth()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-26-1.png" alt="" /><!-- --></p>
<p>Linear model</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_smooth(method = &quot;lm&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-27-1.png" alt="" /><!-- --></p>
<p>Remove SE</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-28-1.png" alt="" /><!-- --></p>
<p>Smooth by group</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-29-1.png" alt="" /><!-- --></p>
</div>
<div id="order-of-layers-in-object-construction" class="section level3">
<h3>Order of layers in object construction</h3>
<p>Order of layers matters</p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_jitter(width = 0.5, height = 0) + geom_boxplot() </code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-30-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot() + geom_jitter(width = 0.5, height = 0) </code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-30-2.png" alt="" /><!-- --></p>
</div>
<div id="scales" class="section level3">
<h3>Scales</h3>
<p>Scales are mainly controlled by <code>scale_*</code> functions. Their names are structured: *scale_‘aestetic name’_‘type’*</p>
<ul>
<li><code>scale_color_discrete</code>: discrete scale for color aestetic</li>
<li><code>scale_fill_gradient</code>: continuous scale for fill aestetic</li>
</ul>
<div id="discrete-scales" class="section level4">
<h4>Discrete scales</h4>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) + geom_point() + scale_color_discrete(h = c(50, 150))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-31-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) + geom_point() + scale_color_brewer(palette = &quot;Set3&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-31-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = factor(cyl))) + geom_point() + scale_color_manual(values = c(&quot;blue&quot;, &quot;black&quot;, &quot;red&quot;, &quot;pink&quot;))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-31-3.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = factor(cyl))) + geom_point() + scale_color_manual(values = c(&#39;8&#39; = &quot;blue&quot;, &#39;6&#39; = &quot;black&quot;, &#39;4&#39; = &quot;red&quot;, &#39;5&#39; = &quot;pink&quot;))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-31-4.png" alt="" /><!-- --></p>
</div>
<div id="gradient-scales" class="section level4">
<h4>gradient scales</h4>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy, color = hwy)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-32-1.png" alt="" /><!-- --></p>
<pre class="r"><code>## 2 colors gradient
ggplot(mpg, aes(x = displ, y = hwy, color = hwy)) + geom_point() + scale_color_gradient(low = &quot;green&quot;, high = &quot;red&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-32-2.png" alt="" /><!-- --></p>
<pre class="r"><code>## diverging color gradient, define low, mid and high colors
ggplot(mpg, aes(x = displ, y = hwy, color = hwy)) + geom_point() + scale_color_gradient2(low = &quot;green&quot;, high = &quot;red&quot;, mid = &quot;black&quot;, midpoint = 25)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-32-3.png" alt="" /><!-- --></p>
<pre class="r"><code>## n colors gradient
ggplot(mpg, aes(x = displ, y = hwy, color = hwy)) + geom_point() + scale_color_gradientn(colours = terrain.colors(10))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-32-4.png" alt="" /><!-- --></p>
</div>
<div id="xlimylim-vs-coord_cartesian" class="section level4">
<h4><code>xlim</code>/<code>ylim</code> vs <code>coord_cartesian</code></h4>
<ul>
<li><code>xlim</code>/<code>ylim</code> select data inside the range</li>
<li>coord_cartesian zoom in the plot</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-33-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + xlim(c(2, 6))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-33-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + coord_cartesian(xlim = c(2, 6))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-33-3.png" alt="" /><!-- --></p>
<p>Warning: when computing densities or smoothers, the plot will completely change by using <code>xlim</code>/<code>ylim</code></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ)) + geom_density(fill = &quot;gray50&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ)) + geom_density(fill = &quot;gray50&quot;) + xlim(c(2, 3))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ)) + geom_density(fill = &quot;gray50&quot;) + coord_cartesian(xlim = c(2, 3))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-3.png" alt="" /><!-- --></p>
</div>
<div id="axis-transformation" class="section level4">
<h4>axis transformation</h4>
<ul>
<li>flip axes</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + coord_flip()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-35-1.png" alt="" /><!-- --></p>
<ul>
<li>polar coordinates</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + coord_polar()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-36-1.png" alt="" /><!-- --></p>
<ul>
<li>reverse axis</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + scale_x_reverse()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-37-1.png" alt="" /><!-- --></p>
<ul>
<li>log axis</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + scale_x_log10()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-38-1.png" alt="" /><!-- --></p>
<ul>
<li>order of discrete scales</li>
</ul>
<pre class="r"><code>ggplot(mpg, aes(x = fl)) + geom_bar()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-39-1.png" alt="" /><!-- --></p>
<pre class="r"><code>## change levels order 
mpg$fl2 &lt;- factor(mpg$fl, levels = c(&quot;e&quot;, &quot;p&quot;, &quot;d&quot;, &quot;r&quot;, &quot;c&quot;))
ggplot(mpg, aes(x = fl2)) + geom_bar()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-39-2.png" alt="" /><!-- --></p>
<pre class="r"><code>## or use xlim
ggplot(mpg, aes(x = fl)) + geom_bar() + xlim(c(&quot;e&quot;, &quot;p&quot;, &quot;d&quot;, &quot;r&quot;, &quot;c&quot;))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-39-3.png" alt="" /><!-- --></p>
</div>
</div>
<div id="themes" class="section level3">
<h3>Themes</h3>
<p>Themes allow to have a set of graphics with the same style. Some are predefined <code>theme_default, theme_bw, them_minimal, theme_gray...</code></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + theme_bw()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-40-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + theme_minimal()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-40-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + theme_dark()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-40-3.png" alt="" /><!-- --></p>
<p>We can customize some elements in themes (see <a href="http://docs.ggplot2.org/dev/vignettes/themes.html" class="uri">http://docs.ggplot2.org/dev/vignettes/themes.html</a> for details)</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + theme(panel.background = element_rect(fill = &quot;wheat&quot;), axis.text = element_text(size = 20))</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-41-1.png" alt="" /><!-- --></p>
</div>
<div id="faceting" class="section level3">
<h3>Faceting</h3>
<p>Facetting allows to display plot separately according to discrete variables</p>
<p>Two functions for facetting: - <code>facet_wrap</code> - <code>facet_grid</code></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_wrap(~class)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-42-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_grid(.~class)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-42-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_grid(class~drv)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-42-3.png" alt="" /><!-- --></p>
<p>Controling facet_wrap organisation</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_wrap(~class, ncol = 2)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-43-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_wrap(~class, scales = &quot;free&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-43-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + facet_wrap(~class, scales = &quot;free_x&quot;)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-43-3.png" alt="" /><!-- --></p>
<p>All layers are faceted</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_smooth() + facet_grid(~drv)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-44-1.png" alt="" /><!-- --></p>
</div>
<div id="add-supplementary-information-on-plot" class="section level3">
<h3>add supplementary information on plot</h3>
<div id="add-lines" class="section level4">
<h4>add lines</h4>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_hline(yintercept = 20)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-45-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_vline(xintercept = 4.5)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-45-2.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_abline(slope = -2, intercept = 35)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-45-3.png" alt="" /><!-- --></p>
</div>
<div id="annotate" class="section level4">
<h4>annotate</h4>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + annotate(x = 4, y = 30, geom = &quot;point&quot;, color = &quot;red&quot;, size = 4)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-46-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + annotate(x = 4, y = 30, geom = &quot;label&quot;, label = &quot;annotation&quot;) </code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-46-2.png" alt="" /><!-- --></p>
</div>
<div id="add-data-from-external-data.frame" class="section level4">
<h4>add data from external data.frame</h4>
<pre class="r"><code>d_annot &lt;- data.frame(xpos = c(2, 5, 8), ypos = c(20, 25, 40), lab = c(&quot;l1&quot;, &quot;l2&quot;, &quot;l3&quot;))
ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_label(aes(x = xpos, y = ypos, label = lab), data = d_annot)</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-47-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="programming-with-ggplot2" class="section level3">
<h3>Programming with ggplot2</h3>
<p><code>ggplot2</code> use non standard evaluation (NSE). How to use variables in <code>aes</code>? <code>aes_string</code> allows standard evaluation.</p>
<pre class="r"><code>my_var &lt;- &quot;displ&quot;
ggplot(mpg, aes(x = my_var, y = hwy)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-48-1.png" alt="" /><!-- --></p>
<pre class="r"><code>ggplot(mpg, aes_string(x = my_var, y = &quot;hwy&quot;)) + geom_point()</code></pre>
<p><img src="ggplot2_files/figure-html/unnamed-chunk-48-2.png" alt="" /><!-- --></p>
</div>
<div id="interactivity" class="section level3">
<h3>Interactivity</h3>
<p>For interactive grahics see <code>ggvis</code> or <code>plotly</code> packages</p>
<pre class="r"><code>require(plotly)
g &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point()
ggplotly(g)</code></pre>
</div>
<div id="extensions" class="section level3">
<h3>Extensions</h3>
<ul>
<li><code>ggrepel</code>: smart geom_text and geom_label placement</li>
<li><code>cowplot</code>: several plots on one page</li>
<li><code>ggraph</code>: visualise graph</li>
<li><code>ggmap</code>: plot data on a map</li>
<li><code>factoextra</code>: visualise results of factorial analysis (PCA, CA, MCA, MFA, …)</li>
<li><code>ggbio</code>: visualise genomic data</li>
<li><code>ggdendro</code>: visualise dendrograms and trees</li>
</ul>
</div>
<div id="ressources" class="section level3">
<h3>Ressources</h3>
<ul>
<li><a href="http://docs.ggplot2.org" class="uri">http://docs.ggplot2.org</a></li>
<li>rstudio cheatsheet <a href="http://www.rstudio.com/wp-content/uploads/2015/04/ggplot2-cheatsheet.pdf" class="uri">http://www.rstudio.com/wp-content/uploads/2015/04/ggplot2-cheatsheet.pdf</a></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
